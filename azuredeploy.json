{
    "$schema":  "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
    "contentVersion":  "1.0.0.0",
    "metadata":  {
        "title":  "",
        "description":  "",
        "prerequisites":  "",
        "postDeployment":  [
        ],
        "prerequisitesDeployTemplateFile":  "",
        "lastUpdateTime":  "",
        "entities":  [
        ],
        "tags":  [
        ],
        "support":  {
            "tier":  "community",
            "armtemplate":  "Generated from https://github.com/Azure/Azure-Sentinel/tree/master/Tools/Playbook-ARM-Template-Generator"
        },
        "author":  {
            "name":  ""
        }
    },
    "parameters":  {
        "PlaybookName":  {
            "defaultValue":  "Test-Guest_account_added",
            "type":  "string"
        }
    },
    "variables":  {
        "MicrosoftSentinelConnectionName":  "[concat('MicrosoftSentinel-', parameters('PlaybookName'))]",
        "Azuresentinel-1ConnectionName":  "[concat('Azuresentinel-1-', parameters('PlaybookName'))]",
        "Azuresentinel-2ConnectionName":  "[concat('Azuresentinel-2-', parameters('PlaybookName'))]",
        "AzuremonitorlogsConnectionName":  "[concat('Azuremonitorlogs-', parameters('PlaybookName'))]"
    },
    "resources":  [
        {
            "properties":  {
                "provisioningState":  "Succeeded",
                "state":  "Enabled",
                "definition":  {
                    "$schema":  "https://schema.management.azure.com/providers/Microsoft.Logic/schemas/2016-06-01/workflowdefinition.json#",
                    "contentVersion":  "1.0.0.0",
                    "parameters":  {
                        "$connections":  {
                            "defaultValue":  {
                            },
                            "type":  "Object"
                        }
                    },
                    "triggers":  {
                        "Microsoft_Sentinel_incident":  {
                            "type":  "ApiConnectionWebhook",
                            "inputs":  {
                                "host":  {
                                    "connection":  {
                                        "name":  "@parameters('$connections')['azuresentinel']['connectionId']"
                                    }
                                },
                                "body":  {
                                    "callback_url":  "@{listCallbackUrl()}"
                                },
                                "path":  "/incident-creation"
                            }
                        }
                    },
                    "actions":  {
                        "Entities_-_Get_IPs":  {
                            "runAfter":  {
                            },
                            "type":  "ApiConnection",
                            "inputs":  {
                                "host":  {
                                    "connection":  {
                                        "name":  "@parameters('$connections')['azuresentinel-1']['connectionId']"
                                    }
                                },
                                "method":  "post",
                                "body":  "@triggerBody()?['object']?['properties']?['relatedEntities']",
                                "path":  "/entities/ip"
                            }
                        },
                        "For_each":  {
                            "foreach":  "@body('Entities_-_Get_IPs')?['IPs']",
                            "actions":  {
                                "Condition":  {
                                    "actions":  {
                                        "Add_comment_to_incident_(V3)":  {
                                            "type":  "ApiConnection",
                                            "inputs":  {
                                                "host":  {
                                                    "connection":  {
                                                        "name":  "@parameters('$connections')['azuresentinel-1']['connectionId']"
                                                    }
                                                },
                                                "method":  "post",
                                                "body":  {
                                                    "incidentArmId":  "@triggerBody()?['object']?['id']",
                                                    "message":  "\u003cp class=\"editor-paragraph\"\u003eInvolved IP \"@{item()?['Address']}\" is private.\u003c/p\u003e"
                                                },
                                                "path":  "/Incidents/Comment"
                                            }
                                        }
                                    },
                                    "else":  {
                                        "actions":  {
                                            "HTTP":  {
                                                "type":  "Http",
                                                "inputs":  {
                                                    "uri":  "https://virustotal.com/api/v3/ip_addresses/@{items('For_each')?['Address']}",
                                                    "method":  "GET",
                                                    "headers":  {
                                                        "x-apikey":  "8488692f9c402caac50ad7d7bd471d8d546a6f7a48498ffa0ed3176464fcab4e"
                                                    }
                                                },
                                                "runtimeConfiguration":  {
                                                    "contentTransfer":  {
                                                        "transferMode":  "Chunked"
                                                    }
                                                }
                                            },
                                            "Parse_JSON":  {
                                                "runAfter":  {
                                                    "HTTP":  [
                                                        "Succeeded"
                                                    ]
                                                },
                                                "type":  "ParseJson",
                                                "inputs":  {
                                                    "content":  "@body('HTTP')",
                                                    "schema":  {
                                                        "type":  "object",
                                                        "properties":  {
                                                            "data":  {
                                                                "type":  "object",
                                                                "properties":  {
                                                                    "id":  {
                                                                        "type":  "string"
                                                                    },
                                                                    "type":  {
                                                                        "type":  "string"
                                                                    },
                                                                    "links":  {
                                                                        "type":  "object",
                                                                        "properties":  {
                                                                            "self":  {
                                                                                "type":  "string"
                                                                            }
                                                                        }
                                                                    },
                                                                    "attributes":  {
                                                                        "type":  "object",
                                                                        "properties":  {
                                                                            "network":  {
                                                                                "type":  "string"
                                                                            },
                                                                            "last_analysis_results":  {
                                                                                "type":  "object",
                                                                                "properties":  {
                                                                                    "Acronis":  {
                                                                                        "type":  "object",
                                                                                        "properties":  {
                                                                                            "method":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "engine_name":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "category":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "result":  {
                                                                                                "type":  "string"
                                                                                            }
                                                                                        }
                                                                                    },
                                                                                    "0xSI_f33d":  {
                                                                                        "type":  "object",
                                                                                        "properties":  {
                                                                                            "method":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "engine_name":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "category":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "result":  {
                                                                                                "type":  "string"
                                                                                            }
                                                                                        }
                                                                                    },
                                                                                    "Abusix":  {
                                                                                        "type":  "object",
                                                                                        "properties":  {
                                                                                            "method":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "engine_name":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "category":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "result":  {
                                                                                                "type":  "string"
                                                                                            }
                                                                                        }
                                                                                    },
                                                                                    "ADMINUSLabs":  {
                                                                                        "type":  "object",
                                                                                        "properties":  {
                                                                                            "method":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "engine_name":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "category":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "result":  {
                                                                                                "type":  "string"
                                                                                            }
                                                                                        }
                                                                                    },
                                                                                    "Axur":  {
                                                                                        "type":  "object",
                                                                                        "properties":  {
                                                                                            "method":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "engine_name":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "category":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "result":  {
                                                                                                "type":  "string"
                                                                                            }
                                                                                        }
                                                                                    },
                                                                                    "Criminal IP":  {
                                                                                        "type":  "object",
                                                                                        "properties":  {
                                                                                            "method":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "engine_name":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "category":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "result":  {
                                                                                                "type":  "string"
                                                                                            }
                                                                                        }
                                                                                    },
                                                                                    "AILabs (MONITORAPP)":  {
                                                                                        "type":  "object",
                                                                                        "properties":  {
                                                                                            "method":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "engine_name":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "category":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "result":  {
                                                                                                "type":  "string"
                                                                                            }
                                                                                        }
                                                                                    },
                                                                                    "AlienVault":  {
                                                                                        "type":  "object",
                                                                                        "properties":  {
                                                                                            "method":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "engine_name":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "category":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "result":  {
                                                                                                "type":  "string"
                                                                                            }
                                                                                        }
                                                                                    },
                                                                                    "alphaMountain.ai":  {
                                                                                        "type":  "object",
                                                                                        "properties":  {
                                                                                            "method":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "engine_name":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "category":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "result":  {
                                                                                                "type":  "string"
                                                                                            }
                                                                                        }
                                                                                    },
                                                                                    "AlphaSOC":  {
                                                                                        "type":  "object",
                                                                                        "properties":  {
                                                                                            "method":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "engine_name":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "category":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "result":  {
                                                                                                "type":  "string"
                                                                                            }
                                                                                        }
                                                                                    },
                                                                                    "Antiy-AVL":  {
                                                                                        "type":  "object",
                                                                                        "properties":  {
                                                                                            "method":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "engine_name":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "category":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "result":  {
                                                                                                "type":  "string"
                                                                                            }
                                                                                        }
                                                                                    },
                                                                                    "ArcSight Threat Intelligence":  {
                                                                                        "type":  "object",
                                                                                        "properties":  {
                                                                                            "method":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "engine_name":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "category":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "result":  {
                                                                                                "type":  "string"
                                                                                            }
                                                                                        }
                                                                                    },
                                                                                    "AutoShun":  {
                                                                                        "type":  "object",
                                                                                        "properties":  {
                                                                                            "method":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "engine_name":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "category":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "result":  {
                                                                                                "type":  "string"
                                                                                            }
                                                                                        }
                                                                                    },
                                                                                    "benkow.cc":  {
                                                                                        "type":  "object",
                                                                                        "properties":  {
                                                                                            "method":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "engine_name":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "category":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "result":  {
                                                                                                "type":  "string"
                                                                                            }
                                                                                        }
                                                                                    },
                                                                                    "Bfore.Ai PreCrime":  {
                                                                                        "type":  "object",
                                                                                        "properties":  {
                                                                                            "method":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "engine_name":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "category":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "result":  {
                                                                                                "type":  "string"
                                                                                            }
                                                                                        }
                                                                                    },
                                                                                    "BitDefender":  {
                                                                                        "type":  "object",
                                                                                        "properties":  {
                                                                                            "method":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "engine_name":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "category":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "result":  {
                                                                                                "type":  "string"
                                                                                            }
                                                                                        }
                                                                                    },
                                                                                    "Bkav":  {
                                                                                        "type":  "object",
                                                                                        "properties":  {
                                                                                            "method":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "engine_name":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "category":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "result":  {
                                                                                                "type":  "string"
                                                                                            }
                                                                                        }
                                                                                    },
                                                                                    "Blueliv":  {
                                                                                        "type":  "object",
                                                                                        "properties":  {
                                                                                            "method":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "engine_name":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "category":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "result":  {
                                                                                                "type":  "string"
                                                                                            }
                                                                                        }
                                                                                    },
                                                                                    "Certego":  {
                                                                                        "type":  "object",
                                                                                        "properties":  {
                                                                                            "method":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "engine_name":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "category":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "result":  {
                                                                                                "type":  "string"
                                                                                            }
                                                                                        }
                                                                                    },
                                                                                    "Chong Lua Dao":  {
                                                                                        "type":  "object",
                                                                                        "properties":  {
                                                                                            "method":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "engine_name":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "category":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "result":  {
                                                                                                "type":  "string"
                                                                                            }
                                                                                        }
                                                                                    },
                                                                                    "CINS Army":  {
                                                                                        "type":  "object",
                                                                                        "properties":  {
                                                                                            "method":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "engine_name":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "category":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "result":  {
                                                                                                "type":  "string"
                                                                                            }
                                                                                        }
                                                                                    },
                                                                                    "Cluster25":  {
                                                                                        "type":  "object",
                                                                                        "properties":  {
                                                                                            "method":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "engine_name":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "category":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "result":  {
                                                                                                "type":  "string"
                                                                                            }
                                                                                        }
                                                                                    },
                                                                                    "CRDF":  {
                                                                                        "type":  "object",
                                                                                        "properties":  {
                                                                                            "method":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "engine_name":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "category":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "result":  {
                                                                                                "type":  "string"
                                                                                            }
                                                                                        }
                                                                                    },
                                                                                    "CSIS Security Group":  {
                                                                                        "type":  "object",
                                                                                        "properties":  {
                                                                                            "method":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "engine_name":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "category":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "result":  {
                                                                                                "type":  "string"
                                                                                            }
                                                                                        }
                                                                                    },
                                                                                    "Snort IP sample list":  {
                                                                                        "type":  "object",
                                                                                        "properties":  {
                                                                                            "method":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "engine_name":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "category":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "result":  {
                                                                                                "type":  "string"
                                                                                            }
                                                                                        }
                                                                                    },
                                                                                    "CMC Threat Intelligence":  {
                                                                                        "type":  "object",
                                                                                        "properties":  {
                                                                                            "method":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "engine_name":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "category":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "result":  {
                                                                                                "type":  "string"
                                                                                            }
                                                                                        }
                                                                                    },
                                                                                    "Cyan":  {
                                                                                        "type":  "object",
                                                                                        "properties":  {
                                                                                            "method":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "engine_name":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "category":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "result":  {
                                                                                                "type":  "string"
                                                                                            }
                                                                                        }
                                                                                    },
                                                                                    "Cyble":  {
                                                                                        "type":  "object",
                                                                                        "properties":  {
                                                                                            "method":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "engine_name":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "category":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "result":  {
                                                                                                "type":  "string"
                                                                                            }
                                                                                        }
                                                                                    },
                                                                                    "CyRadar":  {
                                                                                        "type":  "object",
                                                                                        "properties":  {
                                                                                            "method":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "engine_name":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "category":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "result":  {
                                                                                                "type":  "string"
                                                                                            }
                                                                                        }
                                                                                    },
                                                                                    "DNS8":  {
                                                                                        "type":  "object",
                                                                                        "properties":  {
                                                                                            "method":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "engine_name":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "category":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "result":  {
                                                                                                "type":  "string"
                                                                                            }
                                                                                        }
                                                                                    },
                                                                                    "Dr.Web":  {
                                                                                        "type":  "object",
                                                                                        "properties":  {
                                                                                            "method":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "engine_name":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "category":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "result":  {
                                                                                                "type":  "string"
                                                                                            }
                                                                                        }
                                                                                    },
                                                                                    "Ermes":  {
                                                                                        "type":  "object",
                                                                                        "properties":  {
                                                                                            "method":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "engine_name":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "category":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "result":  {
                                                                                                "type":  "string"
                                                                                            }
                                                                                        }
                                                                                    },
                                                                                    "ESET":  {
                                                                                        "type":  "object",
                                                                                        "properties":  {
                                                                                            "method":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "engine_name":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "category":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "result":  {
                                                                                                "type":  "string"
                                                                                            }
                                                                                        }
                                                                                    },
                                                                                    "ESTsecurity":  {
                                                                                        "type":  "object",
                                                                                        "properties":  {
                                                                                            "method":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "engine_name":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "category":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "result":  {
                                                                                                "type":  "string"
                                                                                            }
                                                                                        }
                                                                                    },
                                                                                    "EmergingThreats":  {
                                                                                        "type":  "object",
                                                                                        "properties":  {
                                                                                            "method":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "engine_name":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "category":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "result":  {
                                                                                                "type":  "string"
                                                                                            }
                                                                                        }
                                                                                    },
                                                                                    "Emsisoft":  {
                                                                                        "type":  "object",
                                                                                        "properties":  {
                                                                                            "method":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "engine_name":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "category":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "result":  {
                                                                                                "type":  "string"
                                                                                            }
                                                                                        }
                                                                                    },
                                                                                    "Forcepoint ThreatSeeker":  {
                                                                                        "type":  "object",
                                                                                        "properties":  {
                                                                                            "method":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "engine_name":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "category":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "result":  {
                                                                                                "type":  "string"
                                                                                            }
                                                                                        }
                                                                                    },
                                                                                    "Fortinet":  {
                                                                                        "type":  "object",
                                                                                        "properties":  {
                                                                                            "method":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "engine_name":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "category":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "result":  {
                                                                                                "type":  "string"
                                                                                            }
                                                                                        }
                                                                                    },
                                                                                    "G-Data":  {
                                                                                        "type":  "object",
                                                                                        "properties":  {
                                                                                            "method":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "engine_name":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "category":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "result":  {
                                                                                                "type":  "string"
                                                                                            }
                                                                                        }
                                                                                    },
                                                                                    "GCP Abuse Intelligence":  {
                                                                                        "type":  "object",
                                                                                        "properties":  {
                                                                                            "method":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "engine_name":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "category":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "result":  {
                                                                                                "type":  "string"
                                                                                            }
                                                                                        }
                                                                                    },
                                                                                    "Google Safebrowsing":  {
                                                                                        "type":  "object",
                                                                                        "properties":  {
                                                                                            "method":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "engine_name":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "category":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "result":  {
                                                                                                "type":  "string"
                                                                                            }
                                                                                        }
                                                                                    },
                                                                                    "GreenSnow":  {
                                                                                        "type":  "object",
                                                                                        "properties":  {
                                                                                            "method":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "engine_name":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "category":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "result":  {
                                                                                                "type":  "string"
                                                                                            }
                                                                                        }
                                                                                    },
                                                                                    "Gridinsoft":  {
                                                                                        "type":  "object",
                                                                                        "properties":  {
                                                                                            "method":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "engine_name":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "category":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "result":  {
                                                                                                "type":  "string"
                                                                                            }
                                                                                        }
                                                                                    },
                                                                                    "Heimdal Security":  {
                                                                                        "type":  "object",
                                                                                        "properties":  {
                                                                                            "method":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "engine_name":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "category":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "result":  {
                                                                                                "type":  "string"
                                                                                            }
                                                                                        }
                                                                                    },
                                                                                    "Hunt.io Intelligence":  {
                                                                                        "type":  "object",
                                                                                        "properties":  {
                                                                                            "method":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "engine_name":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "category":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "result":  {
                                                                                                "type":  "string"
                                                                                            }
                                                                                        }
                                                                                    },
                                                                                    "IPsum":  {
                                                                                        "type":  "object",
                                                                                        "properties":  {
                                                                                            "method":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "engine_name":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "category":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "result":  {
                                                                                                "type":  "string"
                                                                                            }
                                                                                        }
                                                                                    },
                                                                                    "Juniper Networks":  {
                                                                                        "type":  "object",
                                                                                        "properties":  {
                                                                                            "method":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "engine_name":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "category":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "result":  {
                                                                                                "type":  "string"
                                                                                            }
                                                                                        }
                                                                                    },
                                                                                    "Kaspersky":  {
                                                                                        "type":  "object",
                                                                                        "properties":  {
                                                                                            "method":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "engine_name":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "category":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "result":  {
                                                                                                "type":  "string"
                                                                                            }
                                                                                        }
                                                                                    },
                                                                                    "Lionic":  {
                                                                                        "type":  "object",
                                                                                        "properties":  {
                                                                                            "method":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "engine_name":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "category":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "result":  {
                                                                                                "type":  "string"
                                                                                            }
                                                                                        }
                                                                                    },
                                                                                    "Lumu":  {
                                                                                        "type":  "object",
                                                                                        "properties":  {
                                                                                            "method":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "engine_name":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "category":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "result":  {
                                                                                                "type":  "string"
                                                                                            }
                                                                                        }
                                                                                    },
                                                                                    "MalwarePatrol":  {
                                                                                        "type":  "object",
                                                                                        "properties":  {
                                                                                            "method":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "engine_name":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "category":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "result":  {
                                                                                                "type":  "string"
                                                                                            }
                                                                                        }
                                                                                    },
                                                                                    "MalwareURL":  {
                                                                                        "type":  "object",
                                                                                        "properties":  {
                                                                                            "method":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "engine_name":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "category":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "result":  {
                                                                                                "type":  "string"
                                                                                            }
                                                                                        }
                                                                                    },
                                                                                    "Malwared":  {
                                                                                        "type":  "object",
                                                                                        "properties":  {
                                                                                            "method":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "engine_name":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "category":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "result":  {
                                                                                                "type":  "string"
                                                                                            }
                                                                                        }
                                                                                    },
                                                                                    "Netcraft":  {
                                                                                        "type":  "object",
                                                                                        "properties":  {
                                                                                            "method":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "engine_name":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "category":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "result":  {
                                                                                                "type":  "string"
                                                                                            }
                                                                                        }
                                                                                    },
                                                                                    "OpenPhish":  {
                                                                                        "type":  "object",
                                                                                        "properties":  {
                                                                                            "method":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "engine_name":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "category":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "result":  {
                                                                                                "type":  "string"
                                                                                            }
                                                                                        }
                                                                                    },
                                                                                    "Phishing Database":  {
                                                                                        "type":  "object",
                                                                                        "properties":  {
                                                                                            "method":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "engine_name":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "category":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "result":  {
                                                                                                "type":  "string"
                                                                                            }
                                                                                        }
                                                                                    },
                                                                                    "PhishFort":  {
                                                                                        "type":  "object",
                                                                                        "properties":  {
                                                                                            "method":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "engine_name":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "category":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "result":  {
                                                                                                "type":  "string"
                                                                                            }
                                                                                        }
                                                                                    },
                                                                                    "PhishLabs":  {
                                                                                        "type":  "object",
                                                                                        "properties":  {
                                                                                            "method":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "engine_name":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "category":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "result":  {
                                                                                                "type":  "string"
                                                                                            }
                                                                                        }
                                                                                    },
                                                                                    "Phishtank":  {
                                                                                        "type":  "object",
                                                                                        "properties":  {
                                                                                            "method":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "engine_name":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "category":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "result":  {
                                                                                                "type":  "string"
                                                                                            }
                                                                                        }
                                                                                    },
                                                                                    "PREBYTES":  {
                                                                                        "type":  "object",
                                                                                        "properties":  {
                                                                                            "method":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "engine_name":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "category":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "result":  {
                                                                                                "type":  "string"
                                                                                            }
                                                                                        }
                                                                                    },
                                                                                    "PrecisionSec":  {
                                                                                        "type":  "object",
                                                                                        "properties":  {
                                                                                            "method":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "engine_name":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "category":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "result":  {
                                                                                                "type":  "string"
                                                                                            }
                                                                                        }
                                                                                    },
                                                                                    "Quick Heal":  {
                                                                                        "type":  "object",
                                                                                        "properties":  {
                                                                                            "method":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "engine_name":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "category":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "result":  {
                                                                                                "type":  "string"
                                                                                            }
                                                                                        }
                                                                                    },
                                                                                    "Quttera":  {
                                                                                        "type":  "object",
                                                                                        "properties":  {
                                                                                            "method":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "engine_name":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "category":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "result":  {
                                                                                                "type":  "string"
                                                                                            }
                                                                                        }
                                                                                    },
                                                                                    "SafeToOpen":  {
                                                                                        "type":  "object",
                                                                                        "properties":  {
                                                                                            "method":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "engine_name":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "category":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "result":  {
                                                                                                "type":  "string"
                                                                                            }
                                                                                        }
                                                                                    },
                                                                                    "Sansec eComscan":  {
                                                                                        "type":  "object",
                                                                                        "properties":  {
                                                                                            "method":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "engine_name":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "category":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "result":  {
                                                                                                "type":  "string"
                                                                                            }
                                                                                        }
                                                                                    },
                                                                                    "Scantitan":  {
                                                                                        "type":  "object",
                                                                                        "properties":  {
                                                                                            "method":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "engine_name":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "category":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "result":  {
                                                                                                "type":  "string"
                                                                                            }
                                                                                        }
                                                                                    },
                                                                                    "SCUMWARE.org":  {
                                                                                        "type":  "object",
                                                                                        "properties":  {
                                                                                            "method":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "engine_name":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "category":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "result":  {
                                                                                                "type":  "string"
                                                                                            }
                                                                                        }
                                                                                    },
                                                                                    "Seclookup":  {
                                                                                        "type":  "object",
                                                                                        "properties":  {
                                                                                            "method":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "engine_name":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "category":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "result":  {
                                                                                                "type":  "string"
                                                                                            }
                                                                                        }
                                                                                    },
                                                                                    "SecureBrain":  {
                                                                                        "type":  "object",
                                                                                        "properties":  {
                                                                                            "method":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "engine_name":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "category":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "result":  {
                                                                                                "type":  "string"
                                                                                            }
                                                                                        }
                                                                                    },
                                                                                    "Segasec":  {
                                                                                        "type":  "object",
                                                                                        "properties":  {
                                                                                            "method":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "engine_name":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "category":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "result":  {
                                                                                                "type":  "string"
                                                                                            }
                                                                                        }
                                                                                    },
                                                                                    "SOCRadar":  {
                                                                                        "type":  "object",
                                                                                        "properties":  {
                                                                                            "method":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "engine_name":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "category":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "result":  {
                                                                                                "type":  "string"
                                                                                            }
                                                                                        }
                                                                                    },
                                                                                    "Sophos":  {
                                                                                        "type":  "object",
                                                                                        "properties":  {
                                                                                            "method":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "engine_name":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "category":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "result":  {
                                                                                                "type":  "string"
                                                                                            }
                                                                                        }
                                                                                    },
                                                                                    "Spam404":  {
                                                                                        "type":  "object",
                                                                                        "properties":  {
                                                                                            "method":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "engine_name":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "category":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "result":  {
                                                                                                "type":  "string"
                                                                                            }
                                                                                        }
                                                                                    },
                                                                                    "StopForumSpam":  {
                                                                                        "type":  "object",
                                                                                        "properties":  {
                                                                                            "method":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "engine_name":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "category":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "result":  {
                                                                                                "type":  "string"
                                                                                            }
                                                                                        }
                                                                                    },
                                                                                    "Sucuri SiteCheck":  {
                                                                                        "type":  "object",
                                                                                        "properties":  {
                                                                                            "method":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "engine_name":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "category":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "result":  {
                                                                                                "type":  "string"
                                                                                            }
                                                                                        }
                                                                                    },
                                                                                    "ThreatHive":  {
                                                                                        "type":  "object",
                                                                                        "properties":  {
                                                                                            "method":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "engine_name":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "category":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "result":  {
                                                                                                "type":  "string"
                                                                                            }
                                                                                        }
                                                                                    },
                                                                                    "Threatsourcing":  {
                                                                                        "type":  "object",
                                                                                        "properties":  {
                                                                                            "method":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "engine_name":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "category":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "result":  {
                                                                                                "type":  "string"
                                                                                            }
                                                                                        }
                                                                                    },
                                                                                    "Trustwave":  {
                                                                                        "type":  "object",
                                                                                        "properties":  {
                                                                                            "method":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "engine_name":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "category":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "result":  {
                                                                                                "type":  "string"
                                                                                            }
                                                                                        }
                                                                                    },
                                                                                    "Underworld":  {
                                                                                        "type":  "object",
                                                                                        "properties":  {
                                                                                            "method":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "engine_name":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "category":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "result":  {
                                                                                                "type":  "string"
                                                                                            }
                                                                                        }
                                                                                    },
                                                                                    "URLhaus":  {
                                                                                        "type":  "object",
                                                                                        "properties":  {
                                                                                            "method":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "engine_name":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "category":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "result":  {
                                                                                                "type":  "string"
                                                                                            }
                                                                                        }
                                                                                    },
                                                                                    "URLQuery":  {
                                                                                        "type":  "object",
                                                                                        "properties":  {
                                                                                            "method":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "engine_name":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "category":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "result":  {
                                                                                                "type":  "string"
                                                                                            }
                                                                                        }
                                                                                    },
                                                                                    "Viettel Threat Intelligence":  {
                                                                                        "type":  "object",
                                                                                        "properties":  {
                                                                                            "method":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "engine_name":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "category":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "result":  {
                                                                                                "type":  "string"
                                                                                            }
                                                                                        }
                                                                                    },
                                                                                    "VIPRE":  {
                                                                                        "type":  "object",
                                                                                        "properties":  {
                                                                                            "method":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "engine_name":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "category":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "result":  {
                                                                                                "type":  "string"
                                                                                            }
                                                                                        }
                                                                                    },
                                                                                    "VX Vault":  {
                                                                                        "type":  "object",
                                                                                        "properties":  {
                                                                                            "method":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "engine_name":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "category":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "result":  {
                                                                                                "type":  "string"
                                                                                            }
                                                                                        }
                                                                                    },
                                                                                    "ViriBack":  {
                                                                                        "type":  "object",
                                                                                        "properties":  {
                                                                                            "method":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "engine_name":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "category":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "result":  {
                                                                                                "type":  "string"
                                                                                            }
                                                                                        }
                                                                                    },
                                                                                    "Webroot":  {
                                                                                        "type":  "object",
                                                                                        "properties":  {
                                                                                            "method":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "engine_name":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "category":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "result":  {
                                                                                                "type":  "string"
                                                                                            }
                                                                                        }
                                                                                    },
                                                                                    "Yandex Safebrowsing":  {
                                                                                        "type":  "object",
                                                                                        "properties":  {
                                                                                            "method":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "engine_name":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "category":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "result":  {
                                                                                                "type":  "string"
                                                                                            }
                                                                                        }
                                                                                    },
                                                                                    "ZeroCERT":  {
                                                                                        "type":  "object",
                                                                                        "properties":  {
                                                                                            "method":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "engine_name":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "category":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "result":  {
                                                                                                "type":  "string"
                                                                                            }
                                                                                        }
                                                                                    },
                                                                                    "desenmascara.me":  {
                                                                                        "type":  "object",
                                                                                        "properties":  {
                                                                                            "method":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "engine_name":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "category":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "result":  {
                                                                                                "type":  "string"
                                                                                            }
                                                                                        }
                                                                                    },
                                                                                    "malwares.com URL checker":  {
                                                                                        "type":  "object",
                                                                                        "properties":  {
                                                                                            "method":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "engine_name":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "category":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "result":  {
                                                                                                "type":  "string"
                                                                                            }
                                                                                        }
                                                                                    },
                                                                                    "securolytics":  {
                                                                                        "type":  "object",
                                                                                        "properties":  {
                                                                                            "method":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "engine_name":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "category":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "result":  {
                                                                                                "type":  "string"
                                                                                            }
                                                                                        }
                                                                                    },
                                                                                    "Xcitium Verdict Cloud":  {
                                                                                        "type":  "object",
                                                                                        "properties":  {
                                                                                            "method":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "engine_name":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "category":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "result":  {
                                                                                                "type":  "string"
                                                                                            }
                                                                                        }
                                                                                    },
                                                                                    "zvelo":  {
                                                                                        "type":  "object",
                                                                                        "properties":  {
                                                                                            "method":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "engine_name":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "category":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "result":  {
                                                                                                "type":  "string"
                                                                                            }
                                                                                        }
                                                                                    },
                                                                                    "ZeroFox":  {
                                                                                        "type":  "object",
                                                                                        "properties":  {
                                                                                            "method":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "engine_name":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "category":  {
                                                                                                "type":  "string"
                                                                                            },
                                                                                            "result":  {
                                                                                                "type":  "string"
                                                                                            }
                                                                                        }
                                                                                    }
                                                                                }
                                                                            },
                                                                            "whois_date":  {
                                                                                "type":  "integer"
                                                                            },
                                                                            "tags":  {
                                                                                "type":  "array"
                                                                            },
                                                                            "continent":  {
                                                                                "type":  "string"
                                                                            },
                                                                            "total_votes":  {
                                                                                "type":  "object",
                                                                                "properties":  {
                                                                                    "harmless":  {
                                                                                        "type":  "integer"
                                                                                    },
                                                                                    "malicious":  {
                                                                                        "type":  "integer"
                                                                                    }
                                                                                }
                                                                            },
                                                                            "reputation":  {
                                                                                "type":  "integer"
                                                                            },
                                                                            "regional_internet_registry":  {
                                                                                "type":  "string"
                                                                            },
                                                                            "as_owner":  {
                                                                                "type":  "string"
                                                                            },
                                                                            "last_analysis_date":  {
                                                                                "type":  "integer"
                                                                            },
                                                                            "whois":  {
                                                                                "type":  "string"
                                                                            },
                                                                            "asn":  {
                                                                                "type":  "integer"
                                                                            },
                                                                            "country":  {
                                                                                "type":  "string"
                                                                            },
                                                                            "last_modification_date":  {
                                                                                "type":  "integer"
                                                                            },
                                                                            "last_analysis_stats":  {
                                                                                "type":  "object",
                                                                                "properties":  {
                                                                                    "malicious":  {
                                                                                        "type":  "integer"
                                                                                    },
                                                                                    "suspicious":  {
                                                                                        "type":  "integer"
                                                                                    },
                                                                                    "undetected":  {
                                                                                        "type":  "integer"
                                                                                    },
                                                                                    "harmless":  {
                                                                                        "type":  "integer"
                                                                                    },
                                                                                    "timeout":  {
                                                                                        "type":  "integer"
                                                                                    }
                                                                                }
                                                                            }
                                                                        }
                                                                    }
                                                                }
                                                            }
                                                        }
                                                    }
                                                }
                                            },
                                            "Condition_1":  {
                                                "actions":  {
                                                    "Append_to_string_variable":  {
                                                        "type":  "AppendToStringVariable",
                                                        "inputs":  {
                                                            "name":  "Malicious IPs",
                                                            "value":  "\u003ctr\u003e\u003ctd style=\"border: 1px solid black;\"\u003e@{item()?['Address']}\u003c/td\u003e\u003ctd style=\"border: 1px solid black;\"\u003e@{body('Parse_JSON')?['data']?['attributes']?['last_analysis_stats']?['malicious']}\u003c/td\u003e\u003ctd style=\"border: 1px solid black;\"\u003e@{body('Parse_JSON')?['data']?['attributes']?['tags']}\u003c/td\u003e\u003ctd style=\"border: 1px solid black;\"\u003e@{body('Parse_JSON')?['data']?['attributes']?['country']}\u003c/td\u003e\u003c/tr\u003e"
                                                        }
                                                    }
                                                },
                                                "runAfter":  {
                                                    "Parse_JSON":  [
                                                        "Succeeded"
                                                    ]
                                                },
                                                "else":  {
                                                    "actions":  {
                                                        "Append_to_string_variable_1":  {
                                                            "type":  "AppendToStringVariable",
                                                            "inputs":  {
                                                                "name":  "Clean IPs",
                                                                "value":  "\u003ctr\u003e\u003ctd style=\"border: 1px solid black;\"\u003e@{item()?['Address']}\u003c/td\u003e\u003ctd style=\"border: 1px solid black;\"\u003e@{body('Parse_JSON')?['data']?['attributes']?['last_analysis_stats']?['malicious']}\u003c/td\u003e\u003ctd style=\"border: 1px solid black;\"\u003e@{body('Parse_JSON')?['data']?['attributes']?['tags']}\u003c/td\u003e\u003ctd style=\"border: 1px solid black;\"\u003e@{body('Parse_JSON')?['data']?['attributes']?['country']}\u003c/td\u003e\u003c/tr\u003e"
                                                            }
                                                        },
                                                        "Append_to_array_variable":  {
                                                            "runAfter":  {
                                                                "Append_to_string_variable_1":  [
                                                                    "Succeeded"
                                                                ]
                                                            },
                                                            "type":  "AppendToArrayVariable",
                                                            "inputs":  {
                                                                "name":  "All IPs",
                                                                "value":  "@item()?['Address']"
                                                            }
                                                        }
                                                    }
                                                },
                                                "expression":  {
                                                    "and":  [
                                                        {
                                                            "greaterOrEquals":  [
                                                                "@body('Parse_JSON')?['data']?['attributes']?['last_analysis_stats']?['malicious']",
                                                                3
                                                            ]
                                                        }
                                                    ]
                                                },
                                                "type":  "If"
                                            }
                                        }
                                    },
                                    "expression":  {
                                        "or":  [
                                            {
                                                "startsWith":  [
                                                    "@items('For_each')?['Address']",
                                                    "127.0."
                                                ]
                                            },
                                            {
                                                "startsWith":  [
                                                    "@item()?['Address']",
                                                    "172.16."
                                                ]
                                            },
                                            {
                                                "startsWith":  [
                                                    "@item()?['Address']",
                                                    "10.0."
                                                ]
                                            },
                                            {
                                                "startsWith":  [
                                                    "@item()?['Address']",
                                                    "192.168."
                                                ]
                                            }
                                        ]
                                    },
                                    "type":  "If"
                                }
                            },
                            "runAfter":  {
                                "Initialize_variable_2":  [
                                    "Succeeded"
                                ]
                            },
                            "type":  "Foreach"
                        },
                        "Initialize_variable":  {
                            "runAfter":  {
                                "Entities_-_Get_IPs":  [
                                    "Succeeded"
                                ]
                            },
                            "type":  "InitializeVariable",
                            "inputs":  {
                                "variables":  [
                                    {
                                        "name":  "Malicious IPs",
                                        "type":  "string",
                                        "value":  "\u003cp\u003e\u003cimg src='https://www.virustotal.com/gui/images/logo.svg' alt='VirusTotal Logo' width='150'/\u003e\u003c/p\u003e\u003ctable style=\"border: 1px solid black; border-collapse: collapse; display: inline-table; width: auto;\"\u003e\u003ctr style=\"border: 1px solid black;\"\u003e\u003cth style=\"border: 1px solid black;\"\u003eIP Address\u003c/th\u003e\u003cth style=\"border: 1px solid black;\"\u003eReputation\u003c/th\u003e\u003cth style=\"border: 1px solid black;\"\u003eTags\u003c/th\u003e\u003cth style=\"border: 1px solid black;\"\u003eCountry\u003c/th\u003e\u003c/tr\u003e"
                                    }
                                ]
                            }
                        },
                        "Initialize_variable_1":  {
                            "runAfter":  {
                                "Initialize_variable":  [
                                    "Succeeded"
                                ]
                            },
                            "type":  "InitializeVariable",
                            "inputs":  {
                                "variables":  [
                                    {
                                        "name":  "Clean IPs",
                                        "type":  "string",
                                        "value":  "\u003cp\u003e\u003cimg src='https://www.virustotal.com/gui/images/logo.svg' alt='VirusTotal Logo' width='150'/\u003e\u003c/p\u003e\u003ctable style=\"border: 1px solid black; border-collapse: collapse; display: inline-table; width: auto;\"\u003e\u003ctr style=\"border: 1px solid black;\"\u003e\u003cth style=\"border: 1px solid black;\"\u003eIP Address\u003c/th\u003e\u003cth style=\"border: 1px solid black;\"\u003eReputation\u003c/th\u003e\u003cth style=\"border: 1px solid black;\"\u003eTags\u003c/th\u003e\u003cth style=\"border: 1px solid black;\"\u003eCountry\u003c/th\u003e\u003c/tr\u003e"
                                    }
                                ]
                            }
                        },
                        "Initialize_variable_2":  {
                            "runAfter":  {
                                "Initialize_variable_1":  [
                                    "Succeeded"
                                ]
                            },
                            "type":  "InitializeVariable",
                            "inputs":  {
                                "variables":  [
                                    {
                                        "name":  "All IPs",
                                        "type":  "array"
                                    }
                                ]
                            }
                        },
                        "Condition_2":  {
                            "actions":  {
                                "Add_comment_to_incident_(V3)_1":  {
                                    "type":  "ApiConnection",
                                    "inputs":  {
                                        "host":  {
                                            "connection":  {
                                                "name":  "@parameters('$connections')['azuresentinel-2']['connectionId']"
                                            }
                                        },
                                        "method":  "post",
                                        "body":  {
                                            "incidentArmId":  "@triggerBody()?['object']?['id']",
                                            "message":  "\u003cp class=\"editor-paragraph\"\u003e@{variables('Malicious IPs')}\u003c/p\u003e"
                                        },
                                        "path":  "/Incidents/Comment"
                                    }
                                }
                            },
                            "runAfter":  {
                                "For_each":  [
                                    "Succeeded"
                                ]
                            },
                            "else":  {
                                "actions":  {
                                    "Condition_3":  {
                                        "actions":  {
                                            "Add_comment_to_incident_(V3)_2":  {
                                                "type":  "ApiConnection",
                                                "inputs":  {
                                                    "host":  {
                                                        "connection":  {
                                                            "name":  "@parameters('$connections')['azuresentinel-2']['connectionId']"
                                                        }
                                                    },
                                                    "method":  "post",
                                                    "body":  {
                                                        "incidentArmId":  "@triggerBody()?['object']?['id']",
                                                        "message":  "\u003cp class=\"editor-paragraph\"\u003e@{variables('Clean IPs')}\u003c/p\u003e"
                                                    },
                                                    "path":  "/Incidents/Comment"
                                                }
                                            }
                                        },
                                        "else":  {
                                            "actions":  {
                                            }
                                        },
                                        "expression":  {
                                            "and":  [
                                                {
                                                    "equals":  [
                                                        "@if(contains(variables('Clean IPs'), '\u003ctd'), 1, 0)",
                                                        1
                                                    ]
                                                }
                                            ]
                                        },
                                        "type":  "If"
                                    }
                                }
                            },
                            "expression":  {
                                "and":  [
                                    {
                                        "equals":  [
                                            "@if(contains(variables('Malicious IPs'), '\u003ctd'), 1, 0)",
                                            1
                                        ]
                                    }
                                ]
                            },
                            "type":  "If"
                        },
                        "Run_query_and_list_results":  {
                            "runAfter":  {
                                "Initialize_variable_4":  [
                                    "Succeeded"
                                ]
                            },
                            "type":  "ApiConnection",
                            "inputs":  {
                                "host":  {
                                    "connection":  {
                                        "name":  "@parameters('$connections')['azuremonitorlogs']['connectionId']"
                                    }
                                },
                                "method":  "post",
                                "body":  "let GroupIDs = dynamic([\"List with Custom AAD GROUP OBJECT ID 1\", \"Custom AAD GROUP OBJECT ID 2\"]);\nAuditLogs\n| where TimeGenerated \u003e= ago(30d)\n| where OperationName in ('Add member to group', 'Add owner to group')\n| extend InitiatingAppName = tostring(InitiatedBy.app.displayName)\n| extend InitiatingAppServicePrincipalId = tostring(InitiatedBy.app.servicePrincipalId)\n| extend InitiatingUserPrincipalName = tostring(InitiatedBy.user.userPrincipalName)\n| extend InitiatingAadUserId = tostring(InitiatedBy.user.id)\n| extend InitiatingIpAddress = tostring(iff(isnotempty(InitiatedBy.user.ipAddress), InitiatedBy.user.ipAddress, InitiatedBy.app.ipAddress))\n// Uncomment the following line to filter events where the inviting user was a guest user\n//| where InitiatedBy has_any (\"CUSTOM DOMAIN NAME#\", \"#EXT#\")\n| mv-apply TargetResource = TargetResources on \n    (\n    where TargetResource.type =~ \"User\"\n    | extend\n        InvitedUserPrincipalName = trim(@'\"', tostring(TargetResource.userPrincipalName)),\n        Properties = TargetResource.modifiedProperties\n    )\n| mv-apply Property = Properties on \n    (\n    where Property.displayName =~ \"Group.DisplayName\"\n    | extend AADGroup = trim('\"', tostring(Property.newValue))\n    )\n| where InvitedUserPrincipalName has_any (\"CUSTOM DOMAIN NAME#\", \"#EXT#\")\n| mv-apply Property = Properties on\n    (\n    where Property.displayName =~ \"Group.ObjectID\"\n    | extend AADGroupId = trim('\"', tostring(Property.newValue))\n    )\n| project-away TargetResource, Property\n| where AADGroupId !in (GroupIDs)\n| where AADGroup != \"All Users\"\n| extend\n    Name = tostring(split(InitiatingUserPrincipalName, '@', 0)[0]),\n    UPNSuffix = tostring(split(InitiatingUserPrincipalName, '@', 1)[0])\n| extend\n    InvitedUserName = tostring(split(InvitedUserPrincipalName, '@', 0)[0]),\n    InvitedUPNSuffix = tostring(split(InvitedUserPrincipalName, '@', 1)[0])",
                                "path":  "/queryData",
                                "queries":  {
                                    "subscriptions":  "8457a4da-dd02-4331-928d-10240983210a",
                                    "resourcegroups":  "RG-NHD",
                                    "resourcetype":  "Log Analytics Workspace",
                                    "resourcename":  "sentinel-NHD",
                                    "timerange":  "Set in query"
                                }
                            }
                        },
                        "Parse_JSON_1":  {
                            "runAfter":  {
                                "Run_query_and_list_results":  [
                                    "Succeeded"
                                ]
                            },
                            "type":  "ParseJson",
                            "inputs":  {
                                "content":  "@body('Run_query_and_list_results')?['value']",
                                "schema":  {
                                    "type":  "array",
                                    "items":  {
                                        "type":  "object",
                                        "properties":  {
                                            "TenantId":  {
                                                "type":  "string"
                                            },
                                            "SourceSystem":  {
                                                "type":  "string"
                                            },
                                            "TimeGenerated":  {
                                                "type":  "string"
                                            },
                                            "ResourceId":  {
                                                "type":  "string"
                                            },
                                            "OperationName":  {
                                                "type":  "string"
                                            },
                                            "OperationVersion":  {
                                                "type":  "string"
                                            },
                                            "Category":  {
                                                "type":  "string"
                                            },
                                            "ResultType":  {
                                                "type":  "string"
                                            },
                                            "ResultSignature":  {
                                                "type":  "string"
                                            },
                                            "ResultDescription":  {
                                                "type":  "string"
                                            },
                                            "DurationMs":  {
                                                "type":  "integer"
                                            },
                                            "CorrelationId":  {
                                                "type":  "string"
                                            },
                                            "Resource":  {
                                                "type":  "string"
                                            },
                                            "ResourceGroup":  {
                                                "type":  "string"
                                            },
                                            "ResourceProvider":  {
                                                "type":  "string"
                                            },
                                            "Identity":  {
                                                "type":  "string"
                                            },
                                            "Level":  {
                                                "type":  "string"
                                            },
                                            "Location":  {
                                                "type":  "string"
                                            },
                                            "AdditionalDetails":  {
                                                "type":  "string"
                                            },
                                            "Id":  {
                                                "type":  "string"
                                            },
                                            "InitiatedBy":  {
                                                "type":  "string"
                                            },
                                            "LoggedByService":  {
                                                "type":  "string"
                                            },
                                            "Result":  {
                                                "type":  "string"
                                            },
                                            "ResultReason":  {
                                                "type":  "string"
                                            },
                                            "TargetResources":  {
                                                "type":  "string"
                                            },
                                            "AADTenantId":  {
                                                "type":  "string"
                                            },
                                            "ActivityDisplayName":  {
                                                "type":  "string"
                                            },
                                            "ActivityDateTime":  {
                                                "type":  "string"
                                            },
                                            "AADOperationType":  {
                                                "type":  "string"
                                            },
                                            "Type":  {
                                                "type":  "string"
                                            },
                                            "InitiatingAppName":  {
                                                "type":  "string"
                                            },
                                            "InitiatingAppServicePrincipalId":  {
                                                "type":  "string"
                                            },
                                            "InitiatingUserPrincipalName":  {
                                                "type":  "string"
                                            },
                                            "InitiatingAadUserId":  {
                                                "type":  "string"
                                            },
                                            "InitiatingIpAddress":  {
                                                "type":  "string"
                                            },
                                            "InvitedUserPrincipalName":  {
                                                "type":  "string"
                                            },
                                            "Properties":  {
                                                "type":  "string"
                                            },
                                            "AADGroup":  {
                                                "type":  "string"
                                            },
                                            "AADGroupId":  {
                                                "type":  "string"
                                            },
                                            "Name":  {
                                                "type":  "string"
                                            },
                                            "UPNSuffix":  {
                                                "type":  "string"
                                            },
                                            "InvitedUserName":  {
                                                "type":  "string"
                                            },
                                            "InvitedUPNSuffix":  {
                                                "type":  "string"
                                            }
                                        },
                                        "required":  [
                                            "TenantId",
                                            "SourceSystem",
                                            "TimeGenerated",
                                            "ResourceId",
                                            "OperationName",
                                            "OperationVersion",
                                            "Category",
                                            "ResultType",
                                            "ResultSignature",
                                            "ResultDescription",
                                            "DurationMs",
                                            "CorrelationId",
                                            "Resource",
                                            "ResourceGroup",
                                            "ResourceProvider",
                                            "Identity",
                                            "Level",
                                            "Location",
                                            "AdditionalDetails",
                                            "Id",
                                            "InitiatedBy",
                                            "LoggedByService",
                                            "Result",
                                            "ResultReason",
                                            "TargetResources",
                                            "AADTenantId",
                                            "ActivityDisplayName",
                                            "ActivityDateTime",
                                            "AADOperationType",
                                            "Type",
                                            "InitiatingAppName",
                                            "InitiatingAppServicePrincipalId",
                                            "InitiatingUserPrincipalName",
                                            "InitiatingAadUserId",
                                            "InitiatingIpAddress",
                                            "InvitedUserPrincipalName",
                                            "Properties",
                                            "AADGroup",
                                            "AADGroupId",
                                            "Name",
                                            "UPNSuffix",
                                            "InvitedUserName",
                                            "InvitedUPNSuffix"
                                        ]
                                    }
                                }
                            }
                        },
                        "For_each_1":  {
                            "foreach":  "@body('Parse_JSON_1')",
                            "actions":  {
                                "HTTP_1":  {
                                    "type":  "Http",
                                    "inputs":  {
                                        "uri":  "https://graph.microsoft.com/v1.0/groups/@{item()['AADGroupId']}/owners",
                                        "method":  "GET",
                                        "authentication":  {
                                            "type":  "ActiveDirectoryOAuth",
                                            "authority":  "https://login.microsoft.com",
                                            "tenant":  "9c33eac7-9cfd-4d1b-9e98-66ed4b1f5438",
                                            "audience":  "https://graph.microsoft.com",
                                            "clientId":  "1909c30b-11a7-4dd6-802b-0ee3594ed4f2",
                                            "secret":  "-dr8Q~YdDvamvPqLXUSdX8WHRfI9.OeRCMsQQcId"
                                        }
                                    },
                                    "runtimeConfiguration":  {
                                        "contentTransfer":  {
                                            "transferMode":  "Chunked"
                                        }
                                    }
                                },
                                "Parse_JSON_2":  {
                                    "runAfter":  {
                                        "HTTP_1":  [
                                            "Succeeded"
                                        ]
                                    },
                                    "type":  "ParseJson",
                                    "inputs":  {
                                        "content":  "@body('HTTP_1')",
                                        "schema":  {
                                            "type":  "object",
                                            "properties":  {
                                                "@@odata.context":  {
                                                    "type":  "string"
                                                },
                                                "value":  {
                                                    "type":  "array",
                                                    "items":  {
                                                        "type":  "object",
                                                        "properties":  {
                                                            "@@odata.type":  {
                                                                "type":  "string"
                                                            },
                                                            "id":  {
                                                                "type":  "string"
                                                            },
                                                            "businessPhones":  {
                                                                "type":  "array"
                                                            },
                                                            "displayName":  {
                                                                "type":  "string"
                                                            },
                                                            "givenName":  {
                                                            },
                                                            "jobTitle":  {
                                                            },
                                                            "mail":  {
                                                            },
                                                            "mobilePhone":  {
                                                            },
                                                            "officeLocation":  {
                                                            },
                                                            "preferredLanguage":  {
                                                            },
                                                            "surname":  {
                                                            },
                                                            "userPrincipalName":  {
                                                                "type":  "string"
                                                            }
                                                        },
                                                        "required":  [
                                                            "@@odata.type",
                                                            "id",
                                                            "businessPhones",
                                                            "displayName",
                                                            "givenName",
                                                            "jobTitle",
                                                            "mail",
                                                            "mobilePhone",
                                                            "officeLocation",
                                                            "preferredLanguage",
                                                            "surname",
                                                            "userPrincipalName"
                                                        ]
                                                    }
                                                }
                                            }
                                        }
                                    }
                                },
                                "For_each_2":  {
                                    "foreach":  "@outputs('Parse_JSON_2')?['body']?['value']",
                                    "actions":  {
                                        "Condition_4":  {
                                            "actions":  {
                                                "Append_to_string_variable_2":  {
                                                    "type":  "AppendToStringVariable",
                                                    "inputs":  {
                                                        "name":  "Benign",
                                                        "value":  "\u003ctr\u003e\u003ctd style=\"border: 1px solid black;\"\u003e@{items('For_each_1')?['InitiatingUserPrincipalName']}\u003c/td\u003e\u003ctd style=\"border: 1px solid black;\"\u003e@{items('For_each_1')?['InvitedUserPrincipalName']}\u003c/td\u003e\u003ctd style=\"border: 1px solid black;\"\u003e@{items('For_each_1')?['AADGroup']}\u003c/td\u003e\u003ctd style=\"border: 1px solid black;\"\u003e@{item()?['userPrincipalName']}\u003c/td\u003e\u003c/tr\u003e"
                                                    }
                                                }
                                            },
                                            "else":  {
                                                "actions":  {
                                                    "Append_to_string_variable_3":  {
                                                        "type":  "AppendToStringVariable",
                                                        "inputs":  {
                                                            "name":  "Suspicious",
                                                            "value":  "\u003ctr\u003e\u003ctd style=\"border: 1px solid black;\"\u003e@{items('For_each_1')?['InitiatingUserPrincipalName']}\u003c/td\u003e\u003ctd style=\"border: 1px solid black;\"\u003e@{items('For_each_1')?['InvitedUserPrincipalName']}\u003c/td\u003e\u003ctd style=\"border: 1px solid black;\"\u003e@{items('For_each_1')?['AADGroup']}\u003c/td\u003e\u003ctd style=\"border: 1px solid black;\"\u003e@{item()?['userPrincipalName']}\u003c/td\u003e\u003c/tr\u003e"
                                                        }
                                                    }
                                                }
                                            },
                                            "expression":  {
                                                "and":  [
                                                    {
                                                        "equals":  [
                                                            "@items('For_each_1')?['InitiatingUserPrincipalName']",
                                                            "@item()?['userPrincipalName']"
                                                        ]
                                                    }
                                                ]
                                            },
                                            "type":  "If"
                                        }
                                    },
                                    "runAfter":  {
                                        "Parse_JSON_2":  [
                                            "Succeeded"
                                        ]
                                    },
                                    "type":  "Foreach"
                                }
                            },
                            "runAfter":  {
                                "Parse_JSON_1":  [
                                    "Succeeded"
                                ]
                            },
                            "type":  "Foreach"
                        },
                        "Initialize_variable_3":  {
                            "runAfter":  {
                                "Condition_2":  [
                                    "Succeeded"
                                ]
                            },
                            "type":  "InitializeVariable",
                            "inputs":  {
                                "variables":  [
                                    {
                                        "name":  "Benign",
                                        "type":  "string",
                                        "value":  "\u003ctable style=\"border: 1px solid black; border-collapse: collapse; display: inline-table; width: auto;\"\u003e\u003ctr style=\"border: 1px solid black;\"\u003e\u003cth style=\"border: 1px solid black;\"\u003eInternal User\u003c/th\u003e\u003cth style=\"border: 1px solid black;\"\u003eExternal User\u003c/th\u003e\u003cth style=\"border: 1px solid black;\"\u003eGroup Name\u003c/th\u003e\u003cth style=\"border: 1px solid black;\"\u003eOwner\u003c/th\u003e\u003c/tr\u003e"
                                    }
                                ]
                            }
                        },
                        "Initialize_variable_4":  {
                            "runAfter":  {
                                "Initialize_variable_3":  [
                                    "Succeeded"
                                ]
                            },
                            "type":  "InitializeVariable",
                            "inputs":  {
                                "variables":  [
                                    {
                                        "name":  "Suspicious",
                                        "type":  "string",
                                        "value":  "\u003ctable style=\"border: 1px solid black; border-collapse: collapse; display: inline-table; width: auto;\"\u003e\u003ctr style=\"border: 1px solid black;\"\u003e\u003cth style=\"border: 1px solid black;\"\u003eInternal User\u003c/th\u003e\u003cth style=\"border: 1px solid black;\"\u003eExternal User\u003c/th\u003e\u003cth style=\"border: 1px solid black;\"\u003eGroup Name\u003c/th\u003e\u003cth style=\"border: 1px solid black;\"\u003eOwner\u003c/th\u003e\u003c/tr\u003e"
                                    }
                                ]
                            }
                        },
                        "Condition_5":  {
                            "actions":  {
                                "Add_comment_to_incident_(V3)_3":  {
                                    "type":  "ApiConnection",
                                    "inputs":  {
                                        "host":  {
                                            "connection":  {
                                                "name":  "@parameters('$connections')['azuresentinel-2']['connectionId']"
                                            }
                                        },
                                        "method":  "post",
                                        "body":  {
                                            "incidentArmId":  "@triggerBody()?['object']?['id']",
                                            "message":  "\u003cp class=\"editor-paragraph\"\u003e@{variables('Suspicious')}\u003c/p\u003e"
                                        },
                                        "path":  "/Incidents/Comment"
                                    }
                                }
                            },
                            "runAfter":  {
                                "For_each_1":  [
                                    "Succeeded"
                                ]
                            },
                            "else":  {
                                "actions":  {
                                    "Condition_6":  {
                                        "actions":  {
                                            "Add_comment_to_incident_(V3)_4":  {
                                                "type":  "ApiConnection",
                                                "inputs":  {
                                                    "host":  {
                                                        "connection":  {
                                                            "name":  "@parameters('$connections')['azuresentinel-2']['connectionId']"
                                                        }
                                                    },
                                                    "method":  "post",
                                                    "body":  {
                                                        "incidentArmId":  "@triggerBody()?['object']?['id']",
                                                        "message":  "\u003cp class=\"editor-paragraph\"\u003e@{variables('Benign')}\u003c/p\u003e"
                                                    },
                                                    "path":  "/Incidents/Comment"
                                                }
                                            }
                                        },
                                        "else":  {
                                            "actions":  {
                                            }
                                        },
                                        "expression":  {
                                            "and":  [
                                                {
                                                    "equals":  [
                                                        "@if(contains(variables('Benign'), '\u003ctd'), 1, 0)",
                                                        1
                                                    ]
                                                }
                                            ]
                                        },
                                        "type":  "If"
                                    }
                                }
                            },
                            "expression":  {
                                "and":  [
                                    {
                                        "equals":  [
                                            "@if(contains(variables('Suspicious'), '\u003ctd'), 1, 0)",
                                            1
                                        ]
                                    }
                                ]
                            },
                            "type":  "If"
                        }
                    },
                    "outputs":  {
                    }
                },
                "parameters":  {
                    "$connections":  {
                        "value":  {
                            "azuresentinel":  {
                                "connectionId":  "[resourceId('Microsoft.Web/connections', variables('MicrosoftSentinelConnectionName'))]",
                                "connectionName":  "[variables('MicrosoftSentinelConnectionName')]",
                                "id":  "[concat('/subscriptions/', subscription().subscriptionId, '/providers/Microsoft.Web/locations/', resourceGroup().location, '/managedApis/Azuresentinel')]",
                                "connectionProperties":  {
                                    "authentication":  {
                                        "type":  "ManagedServiceIdentity"
                                    }
                                }
                            },
                            "azuresentinel-1":  {
                                "connectionId":  "[resourceId('Microsoft.Web/connections', variables('Azuresentinel-1ConnectionName'))]",
                                "connectionName":  "[variables('Azuresentinel-1ConnectionName')]",
                                "id":  "[concat('/subscriptions/', subscription().subscriptionId, '/providers/Microsoft.Web/locations/', resourceGroup().location, '/managedApis/Azuresentinel-1')]",
                                "connectionProperties":  {
                                    "authentication":  {
                                        "type":  "ManagedServiceIdentity"
                                    }
                                }
                            },
                            "azuresentinel-2":  {
                                "connectionId":  "[resourceId('Microsoft.Web/connections', variables('Azuresentinel-2ConnectionName'))]",
                                "connectionName":  "[variables('Azuresentinel-2ConnectionName')]",
                                "id":  "[concat('/subscriptions/', subscription().subscriptionId, '/providers/Microsoft.Web/locations/', resourceGroup().location, '/managedApis/Azuresentinel-2')]"
                            },
                            "azuremonitorlogs":  {
                                "connectionId":  "[resourceId('Microsoft.Web/connections', variables('AzuremonitorlogsConnectionName'))]",
                                "connectionName":  "[variables('AzuremonitorlogsConnectionName')]",
                                "id":  "[concat('/subscriptions/', subscription().subscriptionId, '/providers/Microsoft.Web/locations/', resourceGroup().location, '/managedApis/Azuremonitorlogs')]"
                            }
                        }
                    }
                }
            },
            "name":  "[parameters('PlaybookName')]",
            "type":  "Microsoft.Logic/workflows",
            "location":  "[resourceGroup().location]",
            "identity":  {
                "type":  "SystemAssigned"
            },
            "tags":  {
                "hidden-SentinelTemplateName":  "Test-Guest_account_added",
                "hidden-SentinelTemplateVersion":  "1.0"
            },
            "apiVersion":  "2017-07-01",
            "dependsOn":  [
                "[resourceId('Microsoft.Web/connections', variables('MicrosoftSentinelConnectionName'))]",
                "[resourceId('Microsoft.Web/connections', variables('Azuresentinel-1ConnectionName'))]",
                "[resourceId('Microsoft.Web/connections', variables('Azuresentinel-2ConnectionName'))]",
                "[resourceId('Microsoft.Web/connections', variables('AzuremonitorlogsConnectionName'))]"
            ]
        },
        {
            "type":  "Microsoft.Web/connections",
            "apiVersion":  "2016-06-01",
            "name":  "[variables('MicrosoftSentinelConnectionName')]",
            "location":  "[resourceGroup().location]",
            "kind":  "V1",
            "properties":  {
                "displayName":  "[variables('MicrosoftSentinelConnectionName')]",
                "customParameterValues":  {
                },
                "parameterValueType":  "Alternative",
                "api":  {
                    "id":  "[concat('/subscriptions/', subscription().subscriptionId, '/providers/Microsoft.Web/locations/', resourceGroup().location, '/managedApis/Azuresentinel')]"
                }
            }
        },
        {
            "type":  "Microsoft.Web/connections",
            "apiVersion":  "2016-06-01",
            "name":  "[variables('Azuresentinel-1ConnectionName')]",
            "location":  "[resourceGroup().location]",
            "kind":  "V1",
            "properties":  {
                "displayName":  "[variables('Azuresentinel-1ConnectionName')]",
                "customParameterValues":  {
                },
                "parameterValueType":  "Alternative",
                "api":  {
                    "id":  "[concat('/subscriptions/', subscription().subscriptionId, '/providers/Microsoft.Web/locations/', resourceGroup().location, '/managedApis/Azuresentinel-1')]"
                }
            }
        },
        {
            "type":  "Microsoft.Web/connections",
            "apiVersion":  "2016-06-01",
            "name":  "[variables('Azuresentinel-2ConnectionName')]",
            "location":  "[resourceGroup().location]",
            "kind":  "V1",
            "properties":  {
                "displayName":  "[variables('Azuresentinel-2ConnectionName')]",
                "customParameterValues":  {
                },
                "api":  {
                    "id":  "[concat('/subscriptions/', subscription().subscriptionId, '/providers/Microsoft.Web/locations/', resourceGroup().location, '/managedApis/Azuresentinel-2')]"
                }
            }
        },
        {
            "type":  "Microsoft.Web/connections",
            "apiVersion":  "2016-06-01",
            "name":  "[variables('AzuremonitorlogsConnectionName')]",
            "location":  "[resourceGroup().location]",
            "kind":  "V1",
            "properties":  {
                "displayName":  "[variables('AzuremonitorlogsConnectionName')]",
                "customParameterValues":  {
                },
                "api":  {
                    "id":  "[concat('/subscriptions/', subscription().subscriptionId, '/providers/Microsoft.Web/locations/', resourceGroup().location, '/managedApis/Azuremonitorlogs')]"
                }
            }
        }
    ]
}
